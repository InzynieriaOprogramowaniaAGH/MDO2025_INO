#version=DEVEL
# Generated by Anaconda

# Źródło instalacji (Fedora 41 x86_64)
url --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=fedora-41&arch=x86_64
repo --name=updates --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f41&arch=x86_64

# Podstawowe ustawienia
keyboard --vckeymap=pl --xlayouts='pl'
lang en_US.UTF-8
timezone Europe/Warsaw --utc
network --bootproto=dhcp --device=eth0 --onboot=on --hostname=fedora-milosz

# Hasła
rootpw --iscrypted --allow-ssh $y$j9T$5r/WG/cMjuyzwjuNINTw7uRB$MOG9GO1E1acIRDOxXUz/ntBEhQl/aGVpkE1pPz6qUz9

# Inne
firewall --enabled --service=ssh
selinux --enforcing
firstboot --disable
reboot

# Partycjonowanie
ignoredisk --only-use=sda
autopart
clearpart --all --initlabel

%packages
@^server-product-environment
docker
git
wget
curl
vim
%end

%post --log=/var/log/kickstart-post.log
echo "### Konfiguracja Dockera i uruchomienie kontenera..." > /dev/tty1

systemctl enable docker

cat <<EOF > /etc/rc.d/rc.local
#!/bin/bash
/usr/bin/dockerd &
sleep 10
/usr/bin/docker pull devenes/node-js-dummy-test:latest
/usr/bin/docker run -d -p 80:3000 devenes/node-js-dummy-test:latest
EOF

chmod +x /etc/rc.d/rc.local
%end