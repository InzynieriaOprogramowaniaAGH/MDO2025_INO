# Generated by Anaconda 41.35
# Generated by pykickstart v3.58
#version=DEVEL

url --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=fedora-41&arch=x86_64
repo --name=updates --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f41&arch=x86_64

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network --hostname=oceanbattle-fedora  --bootproto=dhcp --device=eth0 --ipv6=auto --activate

%packages
@^server-product-environment
docker
wget

%end


# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.11.0
ignoredisk --only-use=sda

# Partition clearing information
clearpart --all --initlabel
autopart

# System timezone
timezone Europe/Warsaw --utc

# Root password
rootpw --iscrypted --allow-ssh $y$j9T$cMHNwX8ZrzXHLANmT6O3z3Ix$gFdmW7lGXR/iZjvrsxPgpExtHrX2Xt.U4uic.q79ro3
user --groups=wheel --name=tkurowski --password=$y$j9T$kp1.5QeZm4CD/3Vrle2mrMxm$6yO74KXCOy6tseAQ9SrQq3KxDSNuz0f1ucOQcogFYy8 --iscrypted --gecos="Tomasz Kurowski"



%post --log=/root/post-install.log
systemctl enable docker

# Pobierz obraz i uruchom po starcie (utwórz plik usługi)
cat > /etc/systemd/system/oceanbattle.service << EOF
[Unit]
Description=OceanBattle Container
After=docker.service
Requires=docker.service

[Service]
Restart=always
ExecStart=/usr/bin/docker run --rm kurowskitomek/webapi:latest
ExecStop=/usr/bin/docker stop webapi

[Install]
WantedBy=multi-user.target
EOF

systemctl enable oceanbattle.service
%end
