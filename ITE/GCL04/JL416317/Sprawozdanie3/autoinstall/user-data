autoinstall:
  version: 1
  identity:
    hostname: ubuntu-deploy
    username: deploy_user
    password: "$6$lajyy14vXW2dXjNi$MP7/u0SbZ83pBGlcvH4cgA3QMii8QJ4QjzQWTj0pmrO.b05y14OGsMRg/jMdmOBfqdPXmwuIdyjk7OhjDWDPD1"
  locale: en_US
  keyboard:
    layout: pl
  storage:
    layout:
      name: direct
  packages:
    - curl

  late-commands:
    - mkdir -p /target/opt/WeatherForecastApi
    - curl -L https://github.com/InzynieriaOprogramowaniaAGH/MDO2025_INO/tree/JL416317/ITE/GCL04/JL416317/Sprawozdanie3/artefact > /target/opt/WeatherForecastApi/WeatherForecast.Api
    - chmod +x /target/opt/WeatherForecastApi/WeatherForecast.Api
    - echo '[Unit]
Description=My REST API
After=network.target

[Service]
ExecStart=/opt/WeatherForecastApi/WeatherForecast.Api
Restart=always
User=deploy_user
Environment=ASPNETCORE_URLS=http://+:5000

[Install]
WantedBy=multi-user.target' > /target/etc/systemd/system/weatherforecastapi.service
    - in-target systemctl enable weatherforecastapi.service
    - in-target ufw allow 5000/tcp
    - in-target ufw enable
