---
- name: Main Playbook
  hosts: Endpoints
  become: yes
  gather_facts: no

  tasks:
    - name: Copy inventory file to Endpoints
      ansible.builtin.copy:
        src: ./inventory.yml
        dest: /home/ansible/inventory.yml
        owner: ansible

    - name: Try to copy again
      ansible.builtin.copy:
        src: ./inventory.yml
        dest: /home/ansible/inventory.yml
        owner: ansible

    - name: Update packages
      ansible.builtin.package:
        state: latest

    - name: Restart ssh
      ansible.builtin.service:
        name: ssh
        state: restarted

    - name: Restart rng-tools
      ansible.builtin.service:
        name: rng-tools-debian
        state: restarted
