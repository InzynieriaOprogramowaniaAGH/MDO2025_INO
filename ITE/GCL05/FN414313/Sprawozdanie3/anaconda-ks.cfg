# Generated by Anaconda 41.35
# Generated by pykickstart v3.58
#version=DEVEL

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'

# System language
lang en_US.UTF-8

# Installation source and repo
url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-38&arch=x86_64
repo --name=update --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f38&arch=x86_64

# Network configuration
network --hostname=fedora-pipeline.local

# User configuration
user --groups=wheel --name=filnaw --password=$y$j9T$DPkkFJJkb5B5y0vplaL3jBwA$iQ/o9YZxPyY.FvZQyX0lv/PVlzaP5E2yWwqaEU2xfO8 --iscrypted --gecos="Filnaw"

# Disable root login
rootpw --lock

# Timezone setup
timezone Europe/Warsaw --utc

# Disk setup
ignoredisk --only-use=sda
clearpart --all --initlabel
autopart

# Software selection
%packages
@^server-product-environment
docker
%end

# First boot setup agent
firstboot --enable

# Post-installation script
%post
# Enable Docker service to start on boot
systemctl enable docker

# Optional: Add user 'filnaw' to docker group (for non-root usage)
usermod -aG docker filnaw

# Optional: Create a test Docker container that runs at system startup (if desired)
# mkdir -p /etc/systemd/system/docker-hello.service.d
# echo "[Service]" > /etc/systemd/system/docker-hello.service.d/override.conf
# echo "ExecStartPost=/usr/bin/docker run hello-world" >> /etc/systemd/system/docker-hello.service.d/override.conf

%end

# Automatically reboot after installation
reboot
