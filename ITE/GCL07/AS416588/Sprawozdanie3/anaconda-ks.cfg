# Generated by Anaconda 41.35
# Generated by pykickstart v3.58
#version=DEVEL

# Keyboard layouts
keyboard --vckeymap=pl --xlayouts='pl'
# System language
lang pl_PL.UTF-8

# Network information
network  --bootproto=dhcp --device=enp0s3 --ipv6=auto --activate
network  --hostname=kult

# Źródło instalacji i repozytoria dla Fedora 41
url --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=fedora-41&arch=x86_64
repo --name=update --mirrorlist=https://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f41&arch=x86_64

# Instalowanie wymaganych pakietów
%packages
@^server-product-environment
flatpak
xdg-utils
dbus
fuse
wget
systemd
%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.11.0
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --all --initlabel

# System timezone
timezone Europe/Warsaw --utc

# Root password
rootpw --iscrypted --allow-ssh $y$j9T$kUaWfgBZyWFFnhD/Lafq5v0m$d7rp2N0JKEx6CxwuikJKWt5XqB/3O7Oiq.tjC4xVNd/

user --groups=wheel --name=jaszczur --password=$y$j9T$Bqpg7nsp0k3UaRrWTycl8Nt9$zV7P5XOBw.RnAUoLHtqQEdN.S2NkuHq8b9/bVpsZkR/ --iscrypted --gecos="jaszczur"

%post
# Włącz flatpak i flathub
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
flatpak install --noninteractive -y flathub org.freedesktop.Platform//23.08

# Pobierz aplikację z serwera (np. Jenkins/HTTP)
curl -u jaszczur:11d094176d339fe7de2c736c436e8b6e75 -o /tmp/irssi.flatpak http://192.168.0.113:8080/job/Irssi/lastSuccessfulBuild/artifact/irssi-23.flatpak
flatpak install --user /tmp/irssi.flatpak -y

# Uruchamianie aplikacji co zalogowanie
cat << 'EOF' >> /home/jaszczur/.bash_profile
flatpak run com.example.irssi
EOF

%end

reboot
