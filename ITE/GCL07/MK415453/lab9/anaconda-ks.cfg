# Generated by Anaconda 41.35
# Generated by pykickstart v3.58
#version=DEVEL

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_US.UTF-8

%packages
@^server-product-environment

%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.11.0
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --none --initlabel

# System timezone
timezone Europe/Warsaw --utc

# Root password
rootpw --iscrypted --allow-ssh $y$j9T$F/ogrecjQCFnBm/f5GjsZIBq$TqnLIH4ZJK1w0d71mk5f/iFgUi0B1eof210Jl8KBCi1
user --groups=wheel --name=user --password=$y$j9T$hR2OTJN6HoybX5ji.Uu7iAmW$ZTDgaBkKBpBh2gH6TO1ejPOUA/jfsBLvTnUWpZg4K59 --iscrypted --gecos="user"


%post 

dnf -y install dnf-plugins-core
dnf config-manager --add-repo=https://download.docker.com/linux/fedora/docker-ce.repo

dnf install -y docker-ce docker-ce-cli containerd.io

systemctl enable docker

cat << 'EOF' > /etc/rc.d/rc.local
#!/bin/bash

systemctl start docker
sleep 5  # mała przerwa, żeby daemon ruszył

usermod -aG docker user
docker pull klocekk/node-deploy
docker run -d -p 3000:3000 --name node_container klocekk/node-deploy
EOF

chmod +x /etc/rc.d/rc.local
systemctl enable rc-local
