#version=DEVEL
# Generated by Anaconda 41.35
# Generated by pykickstart v3.58

keyboard --vckeymap=pl --xlayouts='pl'
lang pl_PL.UTF-8

url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-41&arch=x86_64
repo --name=updates --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f41&arch=x86_64

ignoredisk --only-use=sda
clearpart --all --initlabel
autopart

network  --hostname=anacondatest

timezone Europe/Warsaw --utc

rootpw --iscrypted --allow-ssh $y$j9T$EdlH0qTbCbkj9gMAkuj5uRDm$IiKbwuXZzs4aMwX82qfx4BsD3c0HCTeK0YOtfNw8wy0
user --groups=wheel --name=psocala --password=$y$j9T$DKKrBZ/DTxGfL3nY47qmyLG9$4SuT5/d/Fnol7AFh/LhKFTwQW7fVMY.bII6hFc6YK57 --iscrypted --gecos="Paweł Socała"

%packages
@^server-product-environment
xdg-utils
dbus
fuse
wget
curl
flatpak
systemd
%end

firstboot --enable

%post
set -x
exec > /root/postinstall.log 2>&1

# Dodanie repozytorium Flathub (opcjonalne, można usunąć jeśli niepotrzebne)
flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo

# Pobranie pliku .deb z Jenkinsa
curl -u psocala123:117ce25d6ce85c17ed3126f230f30e9d6a \
  -o /tmp/irssi.deb \
  "http://192.168.0.25:8080/job/irssi_pipeline_v2/lastSuccessfulBuild/artifact/irssi_6.0.0-1_amd64.deb"

# Instalacja pakietu .deb
dnf install -y /tmp/irssi.deb

# Dodanie autostartu irssi w .bash_profile użytkownika
mkdir -p /home/psocala
echo 'irssi' >> /home/psocala/.bash_profile
chown psocala:psocala /home/psocala/.bash_profile

# Usunięcie pobranego pliku
rm -f /tmp/irssi.deb

%end

reboot
