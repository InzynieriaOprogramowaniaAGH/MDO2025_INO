# Generated by Anaconda 41.35
# Generated by pykickstart v3.58
#version=DEVEL

# Keyboard layouts
keyboard --vckeymap=pl --xlayouts='pl'
# System language
lang pl_PL.UTF-8
# Network information
network --hostname=fedora.rbnet

%packages
@^custom-environment
dnf
curl
%end

firstboot --enable

url --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=fedora-41&arch=x86_64
repo --name=update --mirrorlist=http://mirrors.fedoraproject.org/mirrorlist?repo=updates-released-f41&arch=x86_64

# Generated using Blivet version 3.11.0
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --all --initlabel

# System timezone
timezone Europe/Warsaw --utc

# Root password
rootpw --iscrypted --allow-ssh $y$j9T$rTXKNUawDpHsssWOIKWo3n4z$1WmcSMOv7RsEsyhUlhv2Kq2p1vBjAF3L7nb9mvzKznC

%post --log=/root/ks-post.log
# Włącz Docker na starcie
systemctl enable docker

cat > /etc/systemd/system/start-mycontainer.service << 'EOF'
[Unit]
Description=Start my Docker container
After=network-online.target docker.service
Wants=network-online.target

[Service]
Type=oneshot
ExecStart=/usr/bin/docker pull docker.io/radbran/kriadep
ExecStart=/usr/bin/docker run -d --restart=always --name=mycontainer docker.io/radbran/kriadep
RemainAfterExit=true

[Install]
WantedBy=multi-user.target
EOF

# Włącz naszą jednostkę, aby uruchomiła się przy starcie
systemctl enable start-mycontainer.service

%end

reboot
