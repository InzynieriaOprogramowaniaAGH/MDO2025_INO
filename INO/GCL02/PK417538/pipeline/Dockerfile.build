FROM ubuntu:latest

RUN apt-get update && apt-get install -y \
      git python3 python3-pip make python3-poetry pipx \
    && pipx install uv \
    && rm -rf /var/lib/apt/lists/*

ENV PATH="/root/.local/bin:${PATH}"

RUN git clone https://github.com/pydantic/pytest-examples.git /app
WORKDIR /app
RUN make install

RUN make test | tee test.log || true

WORKDIR /app
RUN mkdir -p dist \
 && pip3 wheel . --no-deps --wheel-dir dist


