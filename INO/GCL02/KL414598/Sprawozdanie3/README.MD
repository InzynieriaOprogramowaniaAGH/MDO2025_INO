# ğŸ§° Sprawozdanie z konfiguracji Ansible i zarzÄ…dzania artefaktem (Docker)

## ğŸ“¦ 1. Wprowadzenie

Celem projektu byÅ‚o skonfigurowanie Å›rodowiska do zarzÄ…dzania zdalnymi maszynami za pomocÄ… **Ansible** oraz wdraÅ¼anie aplikacji jako kontenera Docker. Projekt wykonaÅ‚em na dwÃ³ch maszynach wirtualnych z systemem **Ubuntu 24.04 LTS**, pracujÄ…cych w Å›rodowisku VirtualBox. Maszyny komunikujÄ… siÄ™ przez sieÄ‡ wewnÄ™trznÄ….

---

## ğŸ–¥ï¸ 2. Przygotowanie maszyn wirtualnych

### Maszyna gÅ‚Ã³wna (`server`)
- System: Ubuntu 24.04 LTS
- UÅ¼ytkownik: `krzysztof`
- Ansible zainstalowany z repozytorium APT
- Interfejs sieciowy z adresem `192.168.100.11`
- Hostname ustawiony na `server`

### Maszyna zdalna (`ansible-target`)
- Minimalna instalacja Ubuntu 24.04
- UÅ¼ytkownik: `ansible` (utworzony podczas instalacji)
- Zainstalowane tylko wymagane pakiety: `openssh-server`, `tar`
- Interfejs sieciowy z adresem `192.168.100.10`
- Hostname ustawiony na `ansible-target`

---

## ğŸ” 3. Konfiguracja dostÄ™pu i poÅ‚Ä…czenia

### Ustawienie hostÃ³w
Na maszynie `server`, w pliku `/etc/hosts`, dodano:

```
192.168.100.10 ansible-target
192.168.100.11 server
```

### Logowanie SSH bez hasÅ‚a

Na `server`:
```bash
ssh-keygen
ssh-copy-id ansible@ansible-target
```

Po tej operacji `server` moÅ¼e logowaÄ‡ siÄ™ do `ansible-target` bez podawania hasÅ‚a.

---

## ğŸ“ 4. Plik inwentaryzacji Ansible

UtworzyÅ‚em plik `inventory.ini`:

```ini
[Orchestrators]
server ansible_host=server ansible_user=krzysztof ansible_port=2222

[Endpoints]
ansible-target ansible_host=ansible-target ansible_user=ansible
```

---

## âš™ï¸ 5. Tworzenie i uruchamianie playbookÃ³w

### ğŸ”„ Pingowanie wszystkich hostÃ³w

```yaml
- hosts: all
  gather_facts: false
  tasks:
    - name: Sprawdzenie Å‚Ä…cznoÅ›ci
      ansible.builtin.ping:
```

### ğŸ“¤ Kopiowanie pliku inwentaryzacji na `ansible-target`

```yaml
- hosts: Endpoints
  gather_facts: false
  tasks:
    - name: Kopiuj inventory.ini
      copy:
        src: ../inventory.ini
        dest: /home/ansible/inventory.ini
```

### ğŸ“¦ Aktualizacja systemu (zdalnie)

```yaml
- hosts: Endpoints
  become: true
  tasks:
    - name: Aktualizacja cache APT
      apt:
        update_cache: yes

    - name: Uaktualnienie pakietÃ³w
      apt:
        upgrade: dist
```

### ğŸ” Restartowanie usÅ‚ug `sshd` i `rngd`

```yaml
- hosts: Endpoints
  become: true
  tasks:
    - name: Restart SSH
      service:
        name: ssh
        state: restarted

    - name: Restart RNGD
      service:
        name: rngd
        state: restarted
      ignore_errors: true
```

### ğŸ§ª Symulacja bÅ‚Ä™dÃ³w

WyÅ‚Ä…czono SSH i/lub interfejs sieciowy na `ansible-target`, a nastÄ™pnie sprawdzono, czy Ansible poprawnie zgÅ‚asza `UNREACHABLE`. DziÄ™ki temu potwierdzono, Å¼e system poprawnie reaguje na awarie.

---

## ğŸ³ 6. ZarzÄ…dzanie aplikacjÄ… w kontenerze

### Tworzenie roli `deploy_container`

```bash
ansible-galaxy init roles/deploy_container
```

`roles/deploy_container/tasks/main.yml`:

```yaml
- name: Zainstaluj Dockera
  become: true
  apt:
    name:
      - docker-ce
      - docker-ce-cli
      - containerd.io
    state: latest
    update_cache: yes

- name: Uruchom Dockera
  become: true
  service:
    name: docker
    state: started
    enabled: true

- name: Uruchom kontener aplikacji
  become: true
  docker_container:
    name: hello-app
    image: nginx:alpine
    state: started
    ports:
      - "8080:80"

- name: Zweryfikuj dostÄ™pnoÅ›Ä‡ aplikacji
  uri:
    url: http://localhost:8080
    status_code: 200
```

### Uruchomienie roli

`playbooks/deploy.yml`:

```yaml
- hosts: Endpoints
  roles:
    - deploy_container
```

---

## ğŸ§¹ 7. Czyszczenie â€” usuwanie kontenera

```yaml
- hosts: Endpoints
  become: true
  tasks:
    - name: UsuÅ„ kontener aplikacji
      docker_container:
        name: hello-app
        state: absent
```

---

## âœ… 8. Podsumowanie

- ğŸ› ï¸ Åšrodowisko Ansible skonfigurowane na dwÃ³ch maszynach
- ğŸ” Logowanie SSH bez hasÅ‚a
- ğŸ§ª DziaÅ‚ajÄ…ce playbooki do:
  - Pingowania
  - Aktualizacji
  - Restartowania usÅ‚ug
  - Kopiowania plikÃ³w
- ğŸ³ Zdalne wdraÅ¼anie aplikacji w kontenerze
- ğŸ“„ UÅ¼ycie roli stworzonej za pomocÄ… `ansible-galaxy`
- âœ… Ansible poprawnie wykrywa awarie hostÃ³w i przerywa operacje

---

> Projekt wykonany w Å›rodowisku testowym VirtualBox  
> Autor: **Twoje imiÄ™ i nazwisko**
