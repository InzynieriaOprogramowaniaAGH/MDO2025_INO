# Dockerfile.test
FROM debian:bullseye

RUN apt-get update && apt-get install -y --no-install-recommends \
      build-essential gettext liblzma-dev ca-certificates \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY xz/ ./

# skip bootstrap, just configure & run the autotools test suite
RUN ./configure \
 && make -j"$(nproc)" check || true \
 && mkdir -p logs \
 && mv tests/*.log logs/xz_test.log

CMD ["bash"]
